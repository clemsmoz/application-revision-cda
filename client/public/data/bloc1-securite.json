{
  "id": "bloc1-securite",
  "bloc": "bloc1",
  "title": "S√©curit√© des Applications Web",
  "icon": "üîí",
  "color": "#EF4444",
  "description": "La s√©curit√© des applications web est essentielle pour prot√©ger les donn√©es des utilisateurs et l'int√©grit√© du syst√®me. Ce module couvre les vuln√©rabilit√©s courantes (OWASP Top 10) et les bonnes pratiques de s√©curisation.",
  "sections": [
    {
      "id": "intro",
      "title": "Introduction √† la S√©curit√© Web",
      "content": [
        {
          "type": "paragraph",
          "text": "La s√©curit√© des applications web vise √† prot√©ger les applications contre les attaques malveillantes. Les vuln√©rabilit√©s peuvent entra√Æner des fuites de donn√©es, des pertes financi√®res et une atteinte √† la r√©putation."
        },
        {
          "type": "definition",
          "term": "OWASP",
          "definition": "Open Web Application Security Project : organisation √† but non lucratif qui publie le Top 10 des vuln√©rabilit√©s web les plus critiques."
        },
        {
          "type": "table",
          "headers": [
            "Principe de S√©curit√©",
            "Description"
          ],
          "rows": [
            [
              "Confidentialit√©",
              "Les donn√©es ne sont accessibles qu'aux people autoris√©es"
            ],
            [
              "Int√©grit√©",
              "Les donn√©es ne peuvent pas √™tre modifi√©es sans autorisation"
            ],
            [
              "Disponibilit√©",
              "Le syst√®me reste accessible aux users l√©gitimes"
            ],
            [
              "Authentification",
              "V√©rifier l'identit√© des users"
            ],
            [
              "Autorisation",
              "Contr√¥ler les permissions d'acc√®s"
            ],
            [
              "Non-r√©pudiation",
              "Tra√ßabilit√© des actions (logs, audit)"
            ]
          ]
        }
      ]
    },
    {
      "id": "owasp-top10",
      "title": "OWASP Top 10 (2021)",
      "content": [
        {
          "type": "paragraph",
          "text": "Le OWASP Top 10 liste les 10 vuln√©rabilit√©s web les plus critiques. Tout d√©veloppeur doit les conna√Ætre et savoir s'en prot√©ger."
        },
        {
          "type": "table",
          "headers": [
            "Rang",
            "Vuln√©rabilit√©",
            "Description"
          ],
          "rows": [
            [
              "A01",
              "Broken Access Control",
              "Contr√¥le d'acc√®s d√©faillant (acc√®s non autoris√© aux ressources)"
            ],
            [
              "A02",
              "Cryptographic Failures",
              "√âchecs cryptographiques (donn√©es sensibles non chiffr√©es)"
            ],
            [
              "A03",
              "Injection",
              "Injection SQL, NoSQL, OS, LDAP (donn√©es malveillantes dans les requ√™tes)"
            ],
            [
              "A04",
              "Insecure Design",
              "Conception non s√©curis√©e (failles d√®s la conception)"
            ],
            [
              "A05",
              "Security Misconfiguration",
              "Mauvaise configuration (permissions, erreurs expos√©es)"
            ],
            [
              "A06",
              "Vulnerable Components",
              "Composants vuln√©rables (biblioth√®ques obsol√®tes)"
            ],
            [
              "A07",
              "Authentication Failures",
              "√âchecs d'authentification (mots de passe faibles, sessions)"
            ],
            [
              "A08",
              "Software and Data Integrity",
              "Int√©grit√© logicielle et des donn√©es (CI/CD non s√©curis√©)"
            ],
            [
              "A09",
              "Logging and Monitoring",
              "Journalisation insuffisante (attaques non d√©tect√©es)"
            ],
            [
              "A10",
              "Server-Side Request Forgery",
              "SSRF : requ√™tes forg√©es c√¥t√© server"
            ]
          ]
        }
      ]
    },
    {
      "id": "injection-sql",
      "title": "Injection SQL",
      "content": [
        {
          "type": "definition",
          "term": "Injection SQL",
          "definition": "Vuln√©rabilit√© permettant √† un attaquant d'injecter du code SQL malveillant dans une requ√™te, pouvant entra√Æner la lecture, modification ou suppression de donn√©es."
        },
        {
          "type": "subtitle",
          "text": "Exemple d'Attaque"
        },
        {
          "type": "code",
          "language": "sql",
          "code": "-- Code vuln√©rable (PHP)\n$email = $_POST['email'];\n$password = $_POST['password'];\n$query = \"SELECT * FROM users WHERE email='$email' AND password='$password'\";\n\n-- Attaque : l'user entre comme email :\n' OR '1'='1' --\n\n-- Requ√™te r√©sultante (contourne l'authentification) :\nSELECT * FROM users WHERE email='' OR '1'='1' --' AND password='...'"
        },
        {
          "type": "subtitle",
          "text": "Protection : Requ√™tes Pr√©par√©es"
        },
        {
          "type": "code",
          "language": "php",
          "code": "// ‚úÖ Utiliser des requ√™tes pr√©par√©es (PDO)\n$stmt = $pdo->prepare(\"SELECT * FROM users WHERE email = ? AND password = ?\");\n$stmt->execute([$email, $password]);\n\n// Ou avec des param√®tres nomm√©s\n$stmt = $pdo->prepare(\"SELECT * FROM users WHERE email = :email AND password = :password\");\n$stmt->execute(['email' => $email, 'password' => $password]);"
        },
        {
          "type": "alert",
          "level": "danger",
          "text": "Ne JAMAIS concat√©ner des donn√©es utilisateur dans des requ√™tes SQL. Toujours utiliser des requ√™tes pr√©par√©es (prepared statements)."
        }
      ]
    },
    {
      "id": "xss",
      "title": "XSS (Cross-Site Scripting)",
      "content": [
        {
          "type": "definition",
          "term": "XSS (Cross-Site Scripting)",
          "definition": "Vuln√©rabilit√© permettant √† un attaquant d'injecter du code JavaScript malveillant dans une page web, ex√©cut√© dans le navigateur des victimes."
        },
        {
          "type": "table",
          "headers": [
            "Type XSS",
            "Description",
            "Exemple"
          ],
          "rows": [
            [
              "Reflected XSS",
              "Script inject√© via URL, refl√©t√© dans la r√©ponse",
              "URL : ?search=<script>alert('XSS')</script>"
            ],
            [
              "Stored XSS",
              "Script stock√© en base de donn√©es, ex√©cut√© √† chaque affichage",
              "Commentaire malveillant enregistr√©"
            ],
            [
              "DOM-based XSS",
              "Script inject√© via manipulation du DOM c√¥t√© client",
              "document.write(location.hash)"
            ]
          ]
        },
        {
          "type": "subtitle",
          "text": "Exemple d'Attaque"
        },
        {
          "type": "code",
          "language": "html",
          "code": "<!-- Code vuln√©rable (PHP) -->\n<p>Hello <?php echo $_GET['name']; ?></p>\n\n<!-- Attaque : url avec ?name=<script>alert('XSS')</script> -->\n<!-- R√©sultat : le script s'ex√©cute dans le navigateur -->"
        },
        {
          "type": "subtitle",
          "text": "Protection : √âchappement des Donn√©es"
        },
        {
          "type": "code",
          "language": "php",
          "code": "// ‚úÖ √âchapper les donn√©es avant affichage\n<p>Hello <?php echo htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8'); ?></p>\n\n// En JavaScript\nconst name = '<script>alert(\"XSS\")</script>';\nelement.textContent = name; // ‚úÖ √âchappe automatiquement\nelement.innerHTML = name;   // ‚ùå Dangereux !"
        },
        {
          "type": "alert",
          "level": "danger",
          "text": "Toujours √©chapper les donn√©es utilisateur avant de les afficher dans le HTML. Utiliser `htmlspecialchars()` en PHP, `textContent` en JS."
        }
      ]
    },
    {
      "id": "csrf",
      "title": "CSRF (Cross-Site Request Forgery)",
      "content": [
        {
          "type": "definition",
          "term": "CSRF (Cross-Site Request Forgery)",
          "definition": "Vuln√©rabilit√© permettant √† un attaquant de forcer un utilisateur authentifi√© √† ex√©cuter des actions non d√©sir√©es sur une application web."
        },
        {
          "type": "subtitle",
          "text": "Exemple d'Attaque"
        },
        {
          "type": "code",
          "language": "html",
          "code": "<!-- Site malveillant contenant : -->\n<img src=\"https://banque.com/transfer?to=attacker&amount=1000\" />\n\n<!-- if l'user est connect√© √† banque.com, la requ√™te s'ex√©cute -->"
        },
        {
          "type": "subtitle",
          "text": "Protection : Token CSRF"
        },
        {
          "type": "code",
          "language": "html",
          "code": "<!-- ‚úÖ Add un token CSRF dans les formulaires -->\n<form method=\"POST\" action=\"/transfer\">\n  <input type=\"hidden\" name=\"csrf_token\" value=\"<?php echo $_SESSION['csrf_token']; ?>\" />\n  <input type=\"text\" name=\"amount\" />\n  <button type=\"submit\">Transf√©rer</button>\n</form>"
        },
        {
          "type": "code",
          "language": "php",
          "code": "// V√©rifier le token c√¥t√© server\nif ($_POST['csrf_token'] !== $_SESSION['csrf_token']) {\n  die('CSRF token invalid');\n}"
        },
        {
          "type": "alert",
          "level": "info",
          "text": "Utiliser des tokens CSRF pour toutes les actions sensibles (modification, suppression, paiement)."
        }
      ]
    },
    {
      "id": "authentification",
      "title": "Authentification S√©curis√©e",
      "content": [
        {
          "type": "paragraph",
          "text": "L'authentification v√©rifie l'identit√© des utilisateurs. Elle doit √™tre robuste pour √©viter les acc√®s non autoris√©s."
        },
        {
          "type": "subtitle",
          "text": "Stockage des Mots de Passe"
        },
        {
          "type": "alert",
          "level": "danger",
          "text": "Ne JAMAIS stocker les mots de passe en clair dans la base de donn√©es. Toujours les hacher avec un algorithme s√©curis√©."
        },
        {
          "type": "code",
          "language": "php",
          "code": "// ‚ùå MAUVAIS : stocker en clair\n$password = $_POST['password'];\nINSERT INTO users (email, password) VALUES ('...', '$password');\n\n// ‚úÖ BON : hacher avec bcrypt\n$hash = password_hash($_POST['password'], PASSWORD_BCRYPT);\nINSERT INTO users (email, password) VALUES ('...', '$hash');\n\n// V√©rification\nif (password_verify($_POST['password'], $hash)) {\n  // Mot de passe correct\n}"
        },
        {
          "type": "table",
          "headers": [
            "Algorithme",
            "S√©curit√©",
            "Recommandation"
          ],
          "rows": [
            [
              "MD5",
              "‚ùå Obsol√®te",
              "Ne JAMAIS utiliser"
            ],
            [
              "SHA-1",
              "‚ùå Obsol√®te",
              "Ne JAMAIS utiliser"
            ],
            [
              "bcrypt",
              "‚úÖ S√©curis√©",
              "Recommand√© (PHP : password_hash)"
            ],
            [
              "Argon2",
              "‚úÖ Tr√®s s√©curis√©",
              "Recommand√© (plus r√©cent)"
            ]
          ]
        },
        {
          "type": "subtitle",
          "text": "Bonnes Pratiques"
        },
        {
          "type": "list",
          "items": [
            "Politique de mots de passe forts : longueur minimale (12 caract√®res), complexit√©",
            "Limitation des tentatives : bloquer apr√®s X √©checs (brute force)",
            "Authentification √† deux facteurs (2FA) : SMS, application, cl√© physique",
            "Sessions s√©curis√©es : cookies HttpOnly, Secure, SameSite",
            "Expiration des sessions : d√©connexion automatique apr√®s inactivit√©"
          ]
        }
      ]
    },
    {
      "id": "autorisation",
      "title": "Contr√¥le d'Acc√®s et Autorisation",
      "content": [
        {
          "type": "paragraph",
          "text": "L'autorisation contr√¥le les permissions d'acc√®s aux ressources. Un utilisateur authentifi√© ne doit pas pouvoir acc√©der √† toutes les ressources."
        },
        {
          "type": "subtitle",
          "text": "Principe du Moindre Privil√®ge"
        },
        {
          "type": "paragraph",
          "text": "Chaque utilisateur ne doit avoir que les permissions strictement n√©cessaires √† son r√¥le."
        },
        {
          "type": "code",
          "language": "php",
          "code": "// ‚ùå MAUVAIS : pas de v√©rification\n$user_id = $_GET['id'];\n$user = getUser($user_id); // N'importe qui peut View n'importe quel profil\n\n// ‚úÖ BON : v√©rifier les permissions\n$user_id = $_GET['id'];\nif ($user_id !== $_SESSION['user_id'] && !isAdmin($_SESSION['user_id'])) {\n  die('Acc√®s refus√©');\n}\n$user = getUser($user_id);"
        },
        {
          "type": "subtitle",
          "text": "RBAC (Role-Based Access Control)"
        },
        {
          "type": "paragraph",
          "text": "Attribuer des r√¥les aux utilisateurs (admin, √©diteur, lecteur) et des permissions aux r√¥les."
        },
        {
          "type": "code",
          "language": "sql",
          "code": "-- Tables for RBAC\nCREATE table roles (\n  id INT PRIMARY KEY,\n  name VARCHAR(50)\n);\n\nCREATE table permissions (\n  id INT PRIMARY KEY,\n  name VARCHAR(50)\n);\n\nCREATE table role_permissions (\n  role_id INT,\n  permission_id INT,\n  FOREIGN KEY (role_id) REFERENCES roles(id),\n  FOREIGN KEY (permission_id) REFERENCES permissions(id)\n);\n\nCREATE table user_roles (\n  user_id INT,\n  role_id INT,\n  FOREIGN KEY (user_id) REFERENCES users(id),\n  FOREIGN KEY (role_id) REFERENCES roles(id)\n);"
        }
      ]
    },
    {
      "id": "https",
      "title": "HTTPS et Chiffrement",
      "content": [
        {
          "type": "definition",
          "term": "HTTPS",
          "definition": "HTTP Secure : protocole de communication s√©curis√© utilisant TLS/SSL pour chiffrer les √©changes entre le client et le serveur."
        },
        {
          "type": "paragraph",
          "text": "HTTPS prot√®ge contre l'interception des donn√©es (man-in-the-middle) et garantit l'authenticit√© du serveur."
        },
        {
          "type": "table",
          "headers": [
            "HTTP",
            "HTTPS"
          ],
          "rows": [
            [
              "Donn√©es en clair",
              "Donn√©es chiffr√©es"
            ],
            [
              "Port 80",
              "Port 443"
            ],
            [
              "Vuln√©rable aux √©coutes",
              "Prot√©g√© contre les √©coutes"
            ],
            [
              "Pas de certificat",
              "Certificat SSL/TLS requis"
            ]
          ]
        },
        {
          "type": "alert",
          "level": "danger",
          "text": "Toujours utiliser HTTPS pour les applications web, surtout celles manipulant des donn√©es sensibles (authentification, paiement)."
        },
        {
          "type": "subtitle",
          "text": "Obtenir un Certificat SSL/TLS"
        },
        {
          "type": "list",
          "items": [
            "Let's Encrypt : certificats gratuits et automatis√©s",
            "Cloudflare : certificats gratuits avec CDN",
            "Autorit√©s de certification commerciales : DigiCert, Comodo, etc."
          ]
        }
      ]
    },
    {
      "id": "headers",
      "title": "En-t√™tes de S√©curit√© HTTP",
      "content": [
        {
          "type": "paragraph",
          "text": "Les en-t√™tes HTTP de s√©curit√© permettent de renforcer la s√©curit√© des applications web."
        },
        {
          "type": "table",
          "headers": [
            "En-t√™te",
            "Description",
            "Exemple"
          ],
          "rows": [
            [
              "Content-Security-Policy",
              "Contr√¥le les sources de content autoris√©es (XSS)",
              "default-src 'self'"
            ],
            [
              "X-Frame-Options",
              "Emp√™che le clickjacking",
              "DENY ou SAMEORIGIN"
            ],
            [
              "X-Content-Type-Options",
              "Emp√™che le MIME sniffing",
              "nosniff"
            ],
            [
              "Strict-Transport-Security",
              "Force HTTPS (HSTS)",
              "max-age=31536000"
            ],
            [
              "X-XSS-Protection",
              "Active la protection XSS du navigateur",
              "1; mode=block"
            ],
            [
              "Referrer-Policy",
              "Contr√¥le les informations de r√©f√©rent",
              "no-referrer"
            ]
          ]
        },
        {
          "type": "code",
          "language": "php",
          "code": "// Add des en-t√™tes de s√©curit√© en PHP\nheader(\"Content-Security-Policy: default-src 'self'\");\nheader(\"X-Frame-Options: DENY\");\nheader(\"X-Content-Type-Options: nosniff\");\nheader(\"Strict-Transport-Security: max-age=31536000\");"
        }
      ]
    },
    {
      "id": "validation",
      "title": "Validation et Sanitisation des Donn√©es",
      "content": [
        {
          "type": "paragraph",
          "text": "Ne jamais faire confiance aux donn√©es utilisateur. Toujours valider et nettoyer les entr√©es."
        },
        {
          "type": "subtitle",
          "text": "Validation"
        },
        {
          "type": "paragraph",
          "text": "V√©rifier que les donn√©es respectent le format attendu."
        },
        {
          "type": "code",
          "language": "php",
          "code": "// Validation d'un email\nif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n  die('email invalid');\n}\n\n// Validation d'un number\nif (!is_numeric($age) || $age < 0 || $age > 150) {\n  die('√Çge invalid');\n}"
        },
        {
          "type": "subtitle",
          "text": "Sanitisation"
        },
        {
          "type": "paragraph",
          "text": "Nettoyer les donn√©es pour supprimer les caract√®res dangereux."
        },
        {
          "type": "code",
          "language": "php",
          "code": "// Sanitiser un email\n$email = filter_var($email, FILTER_SANITIZE_EMAIL);\n\n// Sanitiser une cha√Æne\n$name = htmlspecialchars($name, ENT_QUOTES, 'UTF-8');"
        },
        {
          "type": "alert",
          "level": "info",
          "text": "Valider c√¥t√© serveur ET c√¥t√© client. La validation client am√©liore l'UX, mais la validation serveur est obligatoire (le client peut √™tre contourn√©)."
        }
      ]
    }
  ],
  "keyPoints": [
    "OWASP Top 10 : les 10 vuln√©rabilit√©s web les plus critiques √† conna√Ætre.",
    "Injection SQL : utiliser des requ√™tes pr√©par√©es (prepared statements).",
    "XSS : √©chapper les donn√©es utilisateur avant affichage (htmlspecialchars).",
    "CSRF : utiliser des tokens CSRF pour les actions sensibles.",
    "Mots de passe : toujours hacher avec bcrypt ou Argon2, jamais en clair.",
    "HTTPS : obligatoire pour prot√©ger les donn√©es en transit.",
    "Contr√¥le d'acc√®s : v√©rifier les permissions (principe du moindre privil√®ge).",
    "Validation : ne jamais faire confiance aux donn√©es utilisateur (valider et sanitiser)."
  ],
  "resources": [
    {
      "type": "doc",
      "title": "OWASP Top 10 (2021)",
      "url": "https://owasp.org/Top10/"
    },
    {
      "type": "doc",
      "title": "OWASP Cheat Sheet Series",
      "url": "https://cheatsheetseries.owasp.org/"
    },
    {
      "type": "tool",
      "title": "Security Headers (tester les en-t√™tes)",
      "url": "https://securityheaders.com/"
    }
  ]
}