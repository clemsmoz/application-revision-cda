{
  "id": "bloc1-react-tests",
  "bloc": "bloc1",
  "title": "React - Interactions et Tests",
  "icon": "üß™",
  "color": "#61DAFB",
  "description": "Techniques avanc√©es de React : gestion d'√©tat complexe avec Context API et Redux, hooks personnalis√©s, tests unitaires et d'int√©gration avec Jest et React Testing Library.",
  "sections": [
    {
      "id": "context-api",
      "title": "Context API",
      "content": [
        {
          "type": "paragraph",
          "text": "Le **Context API** permet de partager des donn√©es entre composants sans passer par les props (√©vite le prop drilling)."
        },
        {
          "type": "code",
          "language": "javascript",
          "code": "// Cr√©er un Context\nimport { createContext, useContext, useState } from 'react';\n\nconst ThemeContext = createContext();\n\n// Provider\nexport function ThemeProvider({ children }) {\n  const [theme, setTheme] = useState('light');\n  \n  return (\n    <ThemeContext.Provider value={{ theme, setTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\n// Utiliser le Context\nfunction Button() {\n  const { theme, setTheme } = useContext(ThemeContext);\n  \n  return (\n    <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>\n      Toggle Theme ({theme})\n    </button>\n  );\n}"
        },
        {
          "type": "alert",
          "level": "info",
          "text": "Utilisez Context API pour les donn√©es globales (th√®me, langue, utilisateur). Pour un √©tat complexe, pr√©f√©rez Redux."
        }
      ]
    },
    {
      "id": "redux",
      "title": "Redux",
      "content": [
        {
          "type": "paragraph",
          "text": "**Redux** est une biblioth√®que de gestion d'√©tat pr√©visible pour JavaScript. Elle centralise l'√©tat de l'application dans un store unique."
        },
        {
          "type": "table",
          "headers": [
            "Concept",
            "Description"
          ],
          "rows": [
            [
              "Store",
              "Contient l'√©tat global de l'application"
            ],
            [
              "Action",
              "Objet d√©crivant un changement (type + payload)"
            ],
            [
              "Reducer",
              "Fonction pure qui calcule le nouvel √©tat"
            ],
            [
              "Dispatch",
              "Envoie une action au store"
            ],
            [
              "Selector",
              "Extrait des donn√©es du store"
            ]
          ]
        },
        {
          "type": "code",
          "language": "javascript",
          "code": "// Redux Toolkit (moderne)\nimport { createSlice, configureStore } from '@reduxjs/toolkit';\n\n// Slice\nconst counterSlice = createSlice({\n  name: 'counter',\n  initialState: { value: 0 },\n  reducers: {\n    increment: (state) => { state.value += 1; },\n    decrement: (state) => { state.value -= 1; },\n    incrementByAmount: (state, action) => {\n      state.value += action.payload;\n    }\n  }\n});\n\n// Store\nconst store = configureStore({\n  reducer: {\n    counter: counterSlice.reducer\n  }\n});\n\n// Utilisation dans un composant\nimport { useSelector, useDispatch } from 'react-redux';\n\nfunction Counter() {\n  const count = useSelector((state) => state.counter.value);\n  const dispatch = useDispatch();\n  \n  return (\n    <div>\n      <p>Count: {count}</p>\n      <button onClick={() => dispatch(increment())}>+</button>\n      <button onClick={() => dispatch(decrement())}>-</button>\n    </div>\n  );\n}"
        }
      ]
    },
    {
      "id": "hooks-personnalises",
      "title": "Hooks Personnalis√©s",
      "content": [
        {
          "type": "paragraph",
          "text": "Les **hooks personnalis√©s** permettent de r√©utiliser de la logique entre composants."
        },
        {
          "type": "code",
          "language": "javascript",
          "code": "// Hook personnalis√© for fetch\nimport { useState, useEffect } from 'react';\n\nfunction useFetch(url) {\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  \n  useEffect(() => {\n    fetch(url)\n      .then(res => res.json())\n      .then(data => {\n        setData(data);\n        setLoading(false);\n      })\n      .catch(err => {\n        setError(err);\n        setLoading(false);\n      });\n  }, [url]);\n  \n  return { data, loading, error };\n}\n\n// Utilisation\nfunction UserProfile({ userId }) {\n  const { data: user, loading, error } = useFetch(`/api/users/${userId}`);\n  \n  if (loading) return <p>Loading...</p>;\n  if (error) return <p>Error: {error.message}</p>;\n  \n  return <div>{user.name}</div>;\n}"
        },
        {
          "type": "alert",
          "level": "tip",
          "text": "Les hooks personnalis√©s doivent toujours commencer par 'use' (convention)."
        }
      ]
    },
    {
      "id": "tests",
      "title": "Tests avec Jest et React Testing Library",
      "content": [
        {
          "type": "paragraph",
          "text": "**Jest** est un framework de tests JavaScript. **React Testing Library** permet de tester les composants React de mani√®re proche de l'utilisation r√©elle."
        },
        {
          "type": "table",
          "headers": [
            "Type de Test",
            "Description"
          ],
          "rows": [
            [
              "Unitaire",
              "Teste une fonction ou un composant isol√©"
            ],
            [
              "Int√©gration",
              "Teste l'interaction entre plusieurs composants"
            ],
            [
              "E2E (End-to-End)",
              "Teste l'application compl√®te (Cypress, Playwright)"
            ]
          ]
        },
        {
          "type": "code",
          "language": "javascript",
          "code": "// Composant √† tester\nfunction Button({ onClick, children }) {\n  return <button onClick={onClick}>{children}</button>;\n}\n\n// Test\nimport { render, screen, fireEvent } from '@testing-library/react';\nimport Button from './Button';\n\ntest('button calls onClick when clicked', () => {\n  const handleClick = jest.fn();\n  render(<Button onClick={handleClick}>Click me</Button>);\n  \n  const button = screen.getByText('Click me');\n  fireEvent.click(button);\n  \n  expect(handleClick).toHaveBeenCalledTimes(1);\n});"
        },
        {
          "type": "paragraph",
          "text": "**Commandes Jest** : `npm test` (lancer les tests), `npm test -- --coverage` (rapport de couverture)."
        }
      ]
    },
    {
      "id": "bonnes-pratiques",
      "title": "Bonnes Pratiques",
      "content": [
        {
          "type": "list",
          "items": [
            "**√âviter le prop drilling** : Utiliser Context API ou Redux pour les donn√©es globales",
            "**Hooks personnalis√©s** : Extraire la logique r√©utilisable",
            "**Tests** : Tester le comportement, pas l'impl√©mentation",
            "**Immutabilit√©** : Ne jamais muter l'√©tat directement",
            "**Performance** : Utiliser React.memo, useMemo, useCallback pour optimiser",
            "**Accessibilit√©** : Utiliser des attributs ARIA et tester avec screen readers"
          ]
        }
      ]
    }
  ],
  "keyPoints": [
    "Context API : partager des donn√©es sans prop drilling.",
    "Redux : gestion d'√©tat centralis√©e pour applications complexes.",
    "Hooks personnalis√©s : r√©utiliser de la logique entre composants.",
    "Tests : Jest + React Testing Library pour tester le comportement.",
    "Bonnes pratiques : immutabilit√©, performance, accessibilit√©."
  ],
  "resources": [
    {
      "type": "doc",
      "title": "React Context",
      "url": "https://react.dev/reference/react/useContext"
    },
    {
      "type": "doc",
      "title": "Redux Toolkit",
      "url": "https://redux-toolkit.js.org/"
    },
    {
      "type": "doc",
      "title": "React Testing Library",
      "url": "https://testing-library.com/react"
    }
  ]
}